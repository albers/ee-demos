<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:c="http://java.sun.com/jsp/jstl/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:fn="http://java.sun.com/jsp/jstl/functions"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:prime="http://primefaces.org/ui"
  xmlns:provs="http://java.sun.com/jsf/composite/components/provs">

<h:head></h:head>

<h:body>
  <ui:composition template="/WEB-INF/templates/provs_template.xhtml">
    <ui:define name="content">
      <prime:layoutUnit position="center">
        <h:form>
          <h:panelGrid
            columns="2"
            rules="none"
            width="100%"
            columnClasses="leftAlign,rightAlign">

            <h2>Projektzeiten bearbeiten</h2>
            <h:panelGroup>
              <prime:commandButton
                id="buttonSpeichern"
                icon="ui-icon-arrowthickstop-1-s"
                value="speichern"
                ajax="false"
                action="#{zeiterfassungEingabeModel.save}" />
              <prime:commandButton
                id="buttonAbbrechen"
                icon="ui-icon-arrowreturnthick-1-w"
                value="abbrechen"
                ajax="false"
                action="#{zeiterfassungEingabeModel.cancel}"
                immediate="true" />
            </h:panelGroup>
          </h:panelGrid>

          <prime:treeTable
            style="color: red;"
            value="#{zeiterfassungEingabeModel.treeTableAufgaben}"
            var="treeNodeData">
            <prime:column>
              <f:facet name="header">
                <h:outputText value="#{zeiterfassungEingabeModel.buchungsMonat}">
                  <f:convertDateTime pattern="MMMM" />
                </h:outputText>
              </f:facet>
              <h:outputText value="#{treeNodeData.aufgabe.titel}" />
            </prime:column>

            <c:forEach
              begin="1"
              end="#{zeiterfassungEingabeModel.tageInBuchungsMonat}"
              step="1"
              var="tag">
              <prime:column style="margin:0px; padding:0px; text-align:center; width: 50px;" >
                <f:facet name="header">
                  <h:outputText value="#{zeiterfassungEingabeModel.getWochenTag(tag)}" />
                  <br />
                  <h:outputText value="#{tag}">
                    <f:convertNumber pattern="00" />
                  </h:outputText>
                </f:facet>
                <h:inputText
                  id="minuten_#{tag}"
                  value="#{treeNodeData.projektZeiten[tag-1].minuten}"
                  size="4"  style="font-size:xx-small; font-stretch:extra-condensed; margin:0px; padding:0px; text-align:right; border-style:none"
                  rendered="#{not empty treeNodeData.mitarbeiterAufgabe}">
                  <f:converter converterId="de.gedoplan.provs.MinutenConverter"/>
                </h:inputText>
                <prime:message for="minuten_#{tag}" display="text"/>
              </prime:column>
            </c:forEach>
          </prime:treeTable>
        </h:form>
      </prime:layoutUnit>
    </ui:define>
  </ui:composition>
</h:body>
</html>